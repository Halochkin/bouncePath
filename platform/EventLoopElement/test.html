<!--<script type="module" src="../../platform_bubble/FirstConnectedCallbackMixin.js"> </script>-->
<script type="module" src="../../platform_bubble/EventLoop.js"></script>
<body :uid=0>

<event-loop>


    <task :created="1631618374265" :delay="2000" :start="1631789839346" :cb="plus">
        <task :created="1631618374264" :delay="2000" :start="1631789839346" :cb=multiply>
            <task :created="1631618374262" :delay="2000" :start="1631789839346" :cb=divide>
                <int>6</int>
                <int>1</int>
            </task>
            <int>2</int>
            <int>5</int>
        </task>
        <int>3</int>
    </task>


</event-loop>

<h1 :uid=1>hello sunshine</h1>
<div>.....</div>

<script>
  const eventLoopElement = document.querySelector("event-loop");
  const h1 = document.querySelector("h1");

  function logEventLoop(target, e) {
    // target.uid = target.getAttribute(":uid");
    //  const rootNode =  target.getRootNode({composed: false});
    //  rootNode && (rootNode.uid = rootNode.body?.getAttribute(":uid"));
    //  target.dispatchEvent(e, rootNode);
    // const lastEventElement = eventLoopElement.firstChild;
    // console.log(lastEventElement);
  }

  function doSomething(txt) {
    return console.log(txt, new Date().getSeconds());
  }

  function multiply(args) {
    return args.reduce((sum, value) => sum * value);
  }

  function divide(args) {
    return new Promise((resolve, reject) => {
      let res = args.reduce((sum, value) => sum / value);
      resolve(res)
    });
    // return args.reduce((sum, value) => sum / value);
  }

  function plus(args) {
    return args.reduce((sum, value) => sum + value);
  }

   function doFetch(args= [8,4]) {
    return new Promise((resolve, reject) => {
      let res = args.reduce((sum, value) => sum / value);
      resolve(res)
    });
  }


  h1.addEventListener("mousedown", function (e) {
    function doSomething1(txt) {
      return console.log(txt, new Date().getSeconds());
    }

    // console.log("initial time", new Date().getSeconds());
    // setTimeout((txt)=> console.log(txt, new Date().getSeconds()), 3000, "call timeout1 3s");
    // setTimeout(function(){console.log("hello", new Date().getSeconds())}, 4000, "call timeout1.1 3s");
    setTimeout(doFetch, 2000);
    // setTimeout(doSomething, 3000, true);
    // setTimeout(doSomething, 4000, "hello world");
    // setTimeout(doSomething1, 5000, "call timeout3 5s");
  });

  // h1.addEventListener("mousemove", function (e) {
  //   logEventLoop(this, e);
  // });

  // h1.addEventListener("mouseup", function (e) {
  //   logEventLoop(this, e);
  // });

  // h1.addEventListener("click", function (e) {
  //   logEventLoop(this, e);
  //   document.querySelector("div").textContent = "hello div"
  // });

</script>

</body>

