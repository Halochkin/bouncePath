# WhatIs: `<button type="reset">`?
 
Both `<button type="reset">` and `<input type="reset">` represents a button that, when pressed, resets all the fields in the form it belongs to, to their initial values.

Both `<button type="reset">` and `<input type="reset">` can be located inside or outside the `<form>` element. If the reset button nested to form, then its pressing will dispatch reset event on parent form node. In order to use the reset button outside the form, you need to define the form element by adding its id as the value of the `form` attribute.

The `<button type="reset">` element is a button to reset a form. To put text on the button, you add it as a text node child: `<button type="reset">Click here!</button>`. To add text to an `<input type="reset">`, the `value` attribute is used: `<input type="reset" value="Click here!">`. 


In contrast with the `<input type="reset">` element, `<button type="reset">` has extended possibilities to create buttons. For example, you can place any non interactive HTML elements, including links or image.


## Demo: `<button type="reset">`

```html
<form id="form1">
  <input type="reset" value="Click me!">
  
  <button type="reset">
    hello 
    <a href="#sunshine">sunshine</a>
    and 
    <span tabindex="0">blue skies!</span>
  </button>
  
  <a href="#world">
    <button type="reset">hello</button>
    world
  </a>
    
</form>

<button type="reset" form="form1">Reset form outside</button>
<input type="reset" form="form1" value="Reset form outside">

<script>
  window.addEventListener("reset", e => e.preventDefault());

  window.addEventListener("keydown", e => console.log(e.type, e.target.tagName, e));
  window.addEventListener("keypress", e => console.log(e.type, e.target.tagName, e));
  window.addEventListener("click", e => console.log(e.type, e.target.tagName, e));
  window.addEventListener("reset", e => console.log(e.type, e.target.tagName, e));
</script>
```

## The default action of `<button type="reset">`

The default action of `<button type="reset">` is to reset a form. More precisely, the default action is to `reset()` on the parent `<form>` of the reset button.

The default action is triggered by a user-driven `click` event. If there is no `click` event, then there will be no resetting of the form from that button. But. `click` events can be generated by both mouse and keyboard events.

The element should implement this as adding a default action for `keypress` events that will add a default action for that enter. 

todo write up this thing about enter
the problem here is the bad practice on the a href element
1) max make the reset button
2) we make the form element
3) ivar makes the focus event controller  


The `click` event is generated differently for `<a href>` elements and `<button>` and `<input>` elements:
1. If the user presses "Enter" over an `<a href>` element or one of its descendants, then the `click` event is only preceded by a `keydown` event, not a `keypress` event.
2. If the user presses "Enter" over a `<button>`, `<input>`, or other `tabindex` element, then the `click` event is preceded by both a `keydown` and a `keypress` event.
This means that the browser's controller for `click` events need to ensure that the propagation path does not contain an "interactive content" element below the `<a href>` element if it creates a `click` event from the `keydown` event (as this should produce a `keypress` event instead, which then should produce a `click` event to be dispatched on a `target` closer to the `activeElement`).  

## Demo: `<reset-button>`

```html
<script src="../../1d3_defaultAction/demo/addDefaultAction.js"></script>

<script>
  (function () {
    class ResetButton extends HTMLElement {

      static get observedAttributes() {
        return ["value"];
      }

      constructor() {
        super();
        const shadow = this.attachShadow({mode: "closed"});
        shadow.innerHTML = `<span tabindex="0" style="background-color: lightgrey; border: 1px solid grey; margin: 2px; width: 250px; height: 1.2em;"><slot></slot></span>`;
        this._innerDiv = shadow.children[0];
      }

      get value() {
        return this._innerDiv.innerText;
      }

      set value(newValue) {
        this._innerDiv.innerText = newValue;
      }

      get form() {
        for (let parent = this.parentNode; parent instanceof HTMLElement; parent = parent.parentNode) {
          if (parent instanceof HTMLFormElement)
            return parent;
        }
      }

      set form(referencedForm) {
       Object.defineProperty(this, "form", {
          value: referencedForm,
          writable: false
        });
      }

      attributeChangedCallback(name, oldValue, newValue) {
        if (name === "value") {
          this.value = newValue;
        }
      }
    }

    customElements.define("reset-button", ResetButton);

    //default action on click on the reset-button or one of its descendants
    window.addEventListener("click", function (e) {
      if ((!e.isTrusted && !e.isTrustedSimulation)|| e.defaultPrevented)
        return;
      for (let el of e.composedPath()) {
        if (el instanceof HTMLElement && el.matches("reset-button")) {
          if (!el.form && el.hasAttribute("form"))  // && or || here, what has higher priority, parent form or referenced form
            el.form = document.querySelector("#" + el.getAttribute("form"));
          if (!el.form)
            throw new SyntaxError("#" + el.getAttribute("form") + " is not exist");
          e.addDefaultAction(() => !e.defaultPrevented && el.form.reset(), {preventable: el}); 
        }
      }
    }, true);

    //default action on keypress on the reset-button or one of its descendants
    window.addEventListener("keypress", function (e) {
      if (!e.isTrusted|| e.defaultPrevented)
        return;
      for (let el of e.composedPath()) {
        if (el instanceof HTMLElement && el.matches("reset-button")) {
          const clickSimulation = new MouseEvent("click", {composed: true, bubbles: true});
          clickSimulation.isTrustedSimulation = true;
          e.addDefaultAction(() => !e.defaultPrevented && el.dispatchEvent(clickSimulation), {preventable: el});
        }
      }
    }, true);
  })();
</script>

<form id="form1">
  <reset-button>
    hello
    <a href="#sunshine">sunshine</a>
    and
    <span tabindex="0">blue skies!</span>
  </reset-button>
  <hr>
  <a href="#world">
    <reset-button>hello</reset-button>
    world
  </a>
</form>

<reset-button form="form1">hello outside</reset-button>

<script>
  //todo test for preventDefault()
  //window.addEventListener("reset", e => e.preventDefault());  //works correct

  window.addEventListener("keydown", e => console.log(e.type, e.target.tagName, e));
  window.addEventListener("keypress", e => console.log(e.type, e.target.tagName, e));
  window.addEventListener("click", e => console.log(e.type, e.target.tagName, e.isTrusted, e.isTrustedSimulation, e));
  window.addEventListener("reset", e => console.log(e.type, e.target.tagName, e));
</script>
```

`click` are generated as a precursor to the default by either mouse events or `keydown`/`keypress` events. The mousedown/mouseup events are a given, but we can also have  or a `keypress` on an `<input>` or `<button>` element. The `target` of the `click` event is not the same as the `target` of the mouse or Keyboard event. 


## References

* [MDN: reset event](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/reset_event);
* [Spec: Resetting a form](https://www.w3.org/TR/html51/sec-forms.html#resetting-a-form).
